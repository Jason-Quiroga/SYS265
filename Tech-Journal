2/24/2021

EC2 Notes.
I. EC2 Notes
  A. How to create a VM in EC2
    1. Select AWS console to get to the console
    2. Click "Launch a Virtual Machine"
    3. Pick the "Red Hat Enterprise Linux 8 (HVM)" because IT IS FREE, LOOK FOR FREE ONES
    4. Select 64 bit x86
    5. Make sure the type is T2 micro (because it's free)
    6. Click configure details
    7. You can stick with all of the defaults on the next page
    8. Click add storage in the bottom right, but you don't need to add any storage
    9. Click "Review and Launch"
    10. Click Launch
    11. You will be prompted to either choose an existing key pair or make a new one
    12. Create a new key pair called "SYS265-SP21" and make sure you download it as well and put it somewhere safe that you will remember.
    13. Launch the instance (it will take a bit).
    14. You can look up "Instances" in the box, and you can see that your box is running and you can see information about it (IP Address)
    15. Now you can load a CMD to connect to your box via SSH
    16. On the command prompt IN YOUR UBUNTU BOX, change the permissions of your key using the command "chmod 40 Desktop/SYS265-SP21.pem" (ubuntu on my personal desktop, jason
        Username and normal password)
    17. Use the command "ssh ec2-user@[ipaddress] -i [path to key]", in my case "ssh ec2-user@54.197.44.246 -i Desktop/SYS265-SP21.pem"
      a. ssh'ing with the ec2-user at the certain IP and using the input file SYS265-SP21.pem
    18. Now you should be in the system.
  B. How to update the EC2 instance
    1. Type in "sudo yum -y update" and it will update.
  C. How to install python3
    1. "sudo yum install -y python3.8
    2. Use "python3.8" instead of "python3" when inputting commands
  D. How to start a python http server
    1. Create a new directory using the command "mkdir test-firewall"
    2. Enter the directory with "cd test-firewall"
    3. Use the command "echo "Testing EC2 Firewall" > index.html
    4. Start the http server using "python3.8 -m http.server 9000"
    5. In the AWS website, go into the EC2 instance and go to the "Security" tab and open up the security groups
    6. Edit the inbound rules and add a new rule with port 9000 with source "0.0.0.0/0" (meaning all ips) with description "testing firewall" and save rules.
  E. Create a Windows Server "Microsoft Windows Server 2019" (it should be free) and configure it similarly to above, however when you get to step 6 (security groups),
     select use an existing and pick launch-wizard 1.
    1. Add an inbound rule with type "RDP" and the port should switch to 3389, also add everyone as a source and give it the description "RDP Inbound".
    2. To get into the box, you need to know the administrator password. To do this, you will need access to the key file.
    3. On the AWS menu in "Instances", select the windows box and in the top right select where it says "Actions" and select "Security", then "Get windows password".
    4. Select the key pair and then hit decrypt password. Write down this password somewhere.
    5. You now have the password, so you can connect using RDP (mstsc on windows REMOTE DESKTOP).
      a. You can find the IP address to connect on the Window's Server's Instance. Then, when asked for a username and password, select more options and put in "Administrator"
        and the password that you wrote down.



Grafana Notes

I. How to install
  A. Installation
    1. Go on your nmon box and install grafana with the command "sudo yum install grafana -y"
    2. Restart the daemon and start grafana while enabling it to start on startup with, "systemctl daemon-reload", "systemctl start grafana", "systemctl enable grafana".
    3. Allow grafana through the firewall with "firewall-cmd --permanent --add-port=3000/tcp", then reload firewall with "firewall-cmd --reload"
    4. Log on to workstation 1 and connet to nmon's server in the web (10.0.5.11:3000)
    5. Enter the basic username and password (admin admin)
    6. Change password **REMEMBER IT
    7. Click the + icon on the left panel and select create a new dashboard and click "add new panel"
    8. In the new dashboard, go to the query tab
    9. Select -- Grafana --
    10. Click the Save button
    11. Add a very nice descriptive name and click save.
    
    12. Download influxdb using the command "wget https://dl.influxdata.com/influxdb/releases/influxdb2-2.0.3.arm64.rpm", then "sudo yum localinstall influxdb2-2.0.3.arm64.rpm"
    13. Install telegraf with "wget https://dl.influxdata.com/telegraf/releases/telegraf-1.17.2-1.x86_64.rpm", them "sudo yum localinstall telegraf-1.17.2-1.x86_64.rpm"
    14. Install mariadb-server using "sudo yum install mariadb-server"
    15. Start the service with "systemctl start mariadb" and enable it, then type "mysql -u root"
    16. Next, type "CREATE DATABASE grafana CHARACTER SET UTF8 COLLATE UTF8_BIN;"
    17. "CREATE USER 'grafana'@'%' IDENTIFIED BY 'password';
    18. "GRANT ALL PRIVILEGES ON grafana.* TO 'grafana'@'%';
    19. "quit;"
    20. Configure grafana repo with "vi /etc/grafana/grafana.ini"
    21. Under the "Database" section, change the type to "mysql", the user to "grafana", and the password to "password"
    22. Save and start the grafana service with "service grafana-server start"
    23. Enable to start with "systemctl enable --now grafana-server"
    
    24. Enable influx with "systemctl enable --now influxdb"
    25. Install snmp using "sudo yum install net-snmp"
    26. edit snmpd.conf with "vi /etc/snmp/snmpd.conf"
    27. Maybe change stuff? then go next
    28. Enable telegraf "systemctl enable --now telegraf"
    29. 




2/4/21

I. How to setup DHCP on PFSense
  A. Instructions
    1. Log on to WKS01
    2. Open chrome and enter the IP of the firewall (in my case, it's 10.0.5.2)
    3. Log in (for pfsense it was "admin" and "pfsense")
    4. When on PFSense, on the top bar navigate to Services->DHCP Server, then click on LAN when you get to the page
    5. Choose to enable DHCP on the LAN interface
    6. In Range, insert the range that you want the server to run on
    7. Choose Change DHCP display lease time from UTC to local time
    8. Under DNS servers, input the DNS server (10.0.5.5)
    9. Under Gateway, input the gateway (10.0.5.2, the address of the firewall)
    10. Under Domain name, insert the name of the domain (in my case, JASON)
    11. Click the "Save" button at the bottom of the page
    12. Your DNS server should now work. Change your WKS's IP settings to get automatically from DHCP server instead of static, then ipconfig /all to confirm.
II. How to setup SNMP on PFSense
  A. Instructions
    1. When on PFSense, navigate to Services->SNMP
    2. Enable SNMP
    3. Inset System Location (69 Howard), System Contact (Jason Quiroga), and change the Bind Interfaces to LAN.
    4. Click Save
    5. Restart the service on the top where the spiny arrow is
III. How to disable SSH logins for the root account
  A. Log in to server as root (sudo -i)
  B. Type command "vi /etc/ssh/sshd_config"
  C. Find the line where it says "PermitRootLogin yes" and change it to no
  D. Underneath, add the line "AllowUsers [username]" in my case, "AllowUsers jason"
  E. :wq
  F. Restart the service with the command "service sshd restart"
IV. How to allow a port throught the firewall
  A. In Linux Console, type "firewall-cmd --permanent --add-port=[port]/[protocol" ie. "firewall-cmd --permanent --add-port=161/udp"
  B. Reload firewall with "firewall-cmd --reload"
  C. Check that the port is allowed through with "firewall-cmd --query-port=161/udp" and it should respond with "yes"
V. How to install SNMP through the Windows GUI
  A. In server manager, click on the top right where it says "Manage" and click "add roles and features"
  B. Select the server that you want to install it on
  C. Under "Features", select "SNMP Service" and under it "SNMP WMI Provider"
  D. Confirm installation and let it install
VI. How to start a Remote Powershell Session between two windows boxes
  A. Go on powershell on the computer
  B. Use the command "Enter-PSSession [computername]" in my case, "Enter-PSSession ad01-jason"
  C. To exit the session, type "Exit-PSSession"
VII. How to enable the "Computer Management" feature in mgmt01-jason
  A. Start a remote powershell session with ad01-jason
  B. Type the command { Set-NetFirewallRule -DisplayGroup "Remote Event Log Management" -Enabled True }
  C. The command should go through and you should now be able to remotely manage AD01 from MGMT01
VIII. How to enable SNMP Services on AD01
  A. On MGMT01, on All Servers, go to ad01 and click "Computer Management"
  B. Click on "Services and Applications", Then click on "Services"
  C. Find SNMP Service in the services
  D. Double click and go to Security Settings
  E. Under accepted community names, add "SYS265" as "READONLY"
  F. Under Accept SNMP Packets from these hosts, add "nmon01-jason"
  G. Click Apply and OK
  H. Restart the service by clicking "Restart the service" on the left
IX. How to use SNMP Service
  A. Use the command "snmpwalk -Os -c SYS265 -v2c ad01-jason"
  B. To find out the line count, you can add "| wc -l" to the end of the command.
  C. By adding "system" to the end, you can see the number of systems running on the computer
X. How to listen to ports on a Linux machine
  A. To listen to a port and display what was in the packets, type "sudo tcpdump -i ens192 port 161 -c10 -AAA" 
    1. "ens192" is the name of the Connection you want to listen to
    2. "161" is the port number which you want to listen to
    3. "-c10" is how many packets you want to listen for (ie. -c24)
    4. "-AAA" Means you're asking for the information in a humanely readable format.
    
    
2/1/21

I. How to Configure Firewall
--> https://drive.google.com/file/d/1a-Kwc611NmL5LO5RuOpHpx0TWYslicZX/view

--> PFSENSE:
- Username: admin
- Password: pfsense

II. How to configure AD01 through commandline
  A. Log on and enter a new password when prompted
  B. Use the command "sconfig" and change the settings to the following:
    1. IP: 10.0.5.5
    2. Netmask: 255.255.255.0
    3. Gateway: 10.0.5.2
    4. Prefered DNS: 10.0.5.2
    5. Computer name: ad01-jason
    6. Manual Windows Update
  C. Restart when prompted for computer name
  D. Now, invoke powershell (using the command "powershell")
  E. Install AD by typing "Install-WindowsFeature AD-Domain-Services -IncludeManagementTools
  F. Install the Forest with the command "Install-ADDSForest -DomainName jason.local" and enter password when prompted
  G. After installation is complete, if you type "whoami", it should return "jason/administrator"
III. How to join a domain through powershell
  A. Open up a command prompt with administrator privileges
  B. Invoke powershell with "powershell" command
  C. Type in the command " add-computer -domainname "jason" -restart " and then type in the username and password of a Domain Administrator (for me, this was a default
  on the AD01 server, so the username was "Administrator" and the password was what I set it to when I configured it first).
  D. Your workstation will restart after implementing the domain change and you should now be a part of the domain.
  
        
HOW TO CONNECT TO THE CYBER.LOCAL SERVER:
1. Login to Remote Student VDI
2. Open Chrome
3. Enter the link "https://vcenter01.cyber.local"
4. Navigate to your systems

SKIFF100-15.CYBER.LOCAL --> Skiff PC

My Network Assignment:
WAN/24: 10.0.17.107
